---
title: "Lab 04 - La Quinta is Spanish for next to Denny's, Pt. 2"
author: "Conor Lacey"
date: "02-07-23"
output: github_document
---

### Load packages and data

```{r load-packages, message = FALSE}
suppressWarnings(library(tidyverse))
library(dsbox) 
library(ggplot2)
library(psych)
```

```{r load-data, message = FALSE}
states <- read_csv("data/states.csv")
dn <- dennys
lq <- laquinta
```

### Exercise 1

```{r Dennys-Alaska}
dn_ak <- dn %>%
  filter(state == "AK")
nrow(dn_ak)
```

Wow. There are only 3 Denny's locations in Alasksa.

### Exercise 2

```{r La_Quinta-Alaska}
lq_ak <- lq %>%
  filter(state == "AK")
nrow(lq_ak)
```

Alaska is not very popular. There are only 2 La Quintas in Alaska.

### Exercise 3

Now we need to join all Denny's locations with all La Quinta locations in Alaska. From the looks of things we will need to calculate 6 distances. 
```{r join-lq_ak-dn_ak}
dn_lq_ak <- full_join(dn_ak, lq_ak, by = "state")
dn_lq_ak
```

### Exercise 4

There are 6 observations in the dn_lq_ak data set. The names of the variables are as follows: 
```{r dn_lq_ak-variables}
colnames(dn_lq_ak)
```

### Exercise 5

We can use the mutate function to add a new variable to a data frame while keeping the existing variables.

### Exercise 6

```{r dn_lq_ak-distances}
source("haversine.R")
dn_lq_ak <- dn_lq_ak %>% mutate(distance = haversine(dn_lq_ak$longitude.x,dn_lq_ak$latitude.x,
                                                      dn_lq_ak$longitude.y,dn_lq_ak$latitude.y))
dn_lq_ak["distance"]
```

### Exercise 7

```{r dn_lq_ak-mindist}
dn_lq_ak_mindist <- dn_lq_ak %>%
  group_by(address.x) %>%
  summarize(closest = min(distance))

dn_lq_ak_mindist
```

### Exercise 8

```{r dn_lq_ak_mindist-histogram}
dn_lq_ak_mindist %>% ggplot(aes(x = closest)) +
  geom_histogram(fill = "#7BAFD4", color = "darkblue", binwidth =3) +
  labs(title = "Denny's Distance to Closest La Quinta in Alaska Distribution",
       x = "Distance (km)",
       y = "Number of Locations")
describe(dn_lq_ak_mindist$closest)
```

There is a mean distance of 4.41km from Denny's to the closest La Quinta location and a variance of 4.41km between the 3 Denny's locations. However, with just three data points this is not a lot of information to go off of. 

### Exercise 9 


